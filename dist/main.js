(()=>{"use strict";const e=e=>{let a=0;return{hit:function(){a+=1},isSunk:function(){return e<=a},length:e,getHits:()=>a}},a=e=>({type:e,gameboard:(e=>{const a=function(){const e=[];for(let a=0;a<=9;a++){e[a]=[];for(let o=0;o<=9;o++)e[a][o]=""}return e}(),o=[];function t(e){return!(e<0||e>9)}function r(){let a=0;for(let e of o)!0===e.isSunk&&a++;if(console.log(a),a>=10)return(e=>{const a=document.querySelector(".modal"),o=document.querySelector(".overlay");return document.querySelector(".btn").addEventListener("click",(()=>{a.classList.add("hidden"),o.classList.add("hidden"),location.reload()})),{openModal:function(){document.querySelector(".win").textContent=`${e} lost!`,a.classList.remove("hidden"),o.classList.remove("hidden")}}})(`${e}`).openModal(),console.log(`${e} lose`),!0}return{gameboard:a,placeShip:function(e,r,n,d){if(!t(e)||!t(r)||""!==a[e][r])return 2;if("vertical"===d&&t(e+n.length-1))for(let t=e;t<e+n.length;t++){if(""!==a[t][r])return 2;a[t][r]={type:`${n.length}ship`,ship:n,value:"O",isSunk:!1},o.push(a[t][r])}if("horizontal"===d&&t(r+n.length-1))for(let t=r;t<r+n.length;t++){if(""!==a[e][t])return 2;a[e][t]={type:`${n.length}ship`,ship:n,value:"O",isSunk:!1},o.push(a[e][t])}return a},receiveAttack:function(e,o){if(!t(e)||!t(o)||!0===r())return console.log("Attack out of board");{let t=a[e][o];if("●"===t)return;""===t?(a[e][o]="●",console.log("Miss")):"O"===t.value&&(t.ship.hit(),t.value="X",t.ship.isSunk()&&(t.isSunk=!0,console.log("Sunk")),console.log(t.isSunk),r())}},checkEndGame:r}})(e)});let o;document.addEventListener("DOMContentLoaded",(()=>{!function(){const t=document.querySelector(".gameboard-one"),r=document.querySelector(".gameboard-two"),n=a("You"),d=a("Computer"),i=e(4),l=e(3),c=e(3),m=e(2),g=e(2),u=e(2),s=e(1),b=e(1),h=e(1),p=e(1),f=[i,l,c,m,g,u,s,b,h,p];!function(e){let a=Math.random()<.5?"horizontal":"vertical";f.forEach((o=>{let t=!1;for(;!t;){let r=Math.floor(10*Math.random()),n=Math.floor(10*Math.random());2!==e.gameboard.placeShip(r,n,o,a)&&(t=!0)}}))}(n),d.gameboard.placeShip(0,0,i,"horizontal"),d.gameboard.placeShip(9,6,l,"horizontal"),d.gameboard.placeShip(0,9,c,"vertical"),d.gameboard.placeShip(8,0,m,"horizontal"),d.gameboard.placeShip(5,4,g,"vertical"),d.gameboard.placeShip(2,6,u,"horizontal"),d.gameboard.placeShip(8,4,s,"horizontal"),d.gameboard.placeShip(2,2,b,"horizontal"),d.gameboard.placeShip(7,8,h,"horizontal"),d.gameboard.placeShip(5,0,p,"horizontal"),o=function(e,a){const o=document.createElement("div");function t(){o.textContent="";for(let a=0;a<e.gameboard.gameboard.length;a++)for(let t=0;t<e.gameboard.gameboard[a].length;t++){const r=document.createElement("div");"object"==typeof e.gameboard.gameboard[a][t]?(e.gameboard.gameboard[a][t].value="O")&&(r.innerHTML=e.gameboard.gameboard[a][t].value,r.classList.add("black")):"X"===e.gameboard.gameboard[a][t]?(r.innerHTML=e.gameboard.gameboard[a][t],r.classList.add("orange")):r.innerHTML=e.gameboard.gameboard[a][t],o.appendChild(r)}a.append(o)}return o.classList.add("container"),{render:t,attack:function a(o=0){if(o>=99)return void console.log("Maximum attempts reached. Exiting attack function.");let r=Math.floor(10*Math.random()),n=Math.floor(10*Math.random());if("●"!==e.gameboard.gameboard[r][n]&&"X"!==e.gameboard.gameboard[r][n].value&&"X"!==e.gameboard.gameboard[r][n])return e.gameboard.receiveAttack(r,n),"object"==typeof e.gameboard.gameboard[r][n]?(e.gameboard.gameboard[r][n]=e.gameboard.gameboard[r][n].value,setTimeout(a,1e3),void t()):void t();a(o+1)}}}(n,t),function(e,a){const t=document.createElement("div");t.classList.add("container");for(let a=0;a<e.gameboard.gameboard.length;a++)for(let r=0;r<e.gameboard.gameboard[a].length;r++){const n=document.createElement("div");t.appendChild(n),n.addEventListener("click",(()=>{e.gameboard.receiveAttack([a],[r]),"object"==typeof e.gameboard.gameboard[a][r]?(n.innerHTML=e.gameboard.gameboard[a][r].value,n.classList.add("orange")):(n.innerHTML=e.gameboard.gameboard[a][r],setTimeout(o.attack,1e3),o.render())}))}a.append(t)}(d,r),o.render()}()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoibUJBQUEsTUFBTUEsRUFBUUMsSUFFWixJQUFJQyxFQUFPLEVBWVgsTUFBTyxDQUNMQyxJQVhGLFdBQ0VELEdBQVEsQ0FDVixFQVVFRSxPQVJGLFdBQ0UsT0FBSUgsR0FBY0MsQ0FHcEIsRUFLRUcsT0FoQmFKLEVBaUJiSyxRQUFTLElBQU1KLEVBQ2hCLEVDakJHSyxFQUFVQyxJQUtMLENBQ0hDLEtBTFNELEVBTVRFLFVDTlUsQ0FBQ0MsSUFZakIsTUFBTUQsRUFYTixXQUNFLE1BQU1FLEVBQVksR0FDbEIsSUFBSyxJQUFJQyxFQUFJLEVBQUdBLEdBQUssRUFBR0EsSUFBSyxDQUMzQkQsRUFBVUMsR0FBSyxHQUNmLElBQUssSUFBSUMsRUFBSSxFQUFHQSxHQUFLLEVBQUdBLElBQ3RCRixFQUFVQyxHQUFHQyxHQUFLLEVBRXRCLENBQ0EsT0FBT0YsQ0FDVCxDQUVrQkcsR0FDWkMsRUFBUSxHQUVkLFNBQVNDLEVBQWdCQyxHQUN2QixRQUFJQSxFQUFRLEdBQUtBLEVBQVEsRUFLM0IsQ0E2SEEsU0FBU0MsSUFDUCxJQUFJQyxFQUFVLEVBQ2QsSUFBSyxJQUFJQyxLQUFRTCxHQUNLLElBQWhCSyxFQUFLakIsUUFDUGdCLElBSUosR0FEQUUsUUFBUUMsSUFBSUgsR0FDUkEsR0FBVyxHQUliLE1DaEVRLENBQUNJLElBQ1gsTUFBTUMsRUFBUUMsU0FBU0MsY0FBYyxVQUMvQkMsRUFBVUYsU0FBU0MsY0FBYyxZQW9CdkMsT0FuQm1CRCxTQUFTQyxjQUFjLFFBQy9CRSxpQkFBaUIsU0FBUyxLQWFqQ0osRUFBTUssVUFBVUMsSUFBSSxVQUNwQkgsRUFBUUUsVUFBVUMsSUFBSSxVQUN0QkMsU0FBU0MsUUFkRSxJQWlCUixDQUFDQyxVQWJSLFdBQ3VCUixTQUFTQyxjQUFjLFFBQy9CUSxZQUFjLEdBQUdYLFVBQzVCQyxFQUFNSyxVQUFVTSxPQUFPLFVBQ3ZCUixFQUFRRSxVQUFVTSxPQUFPLFNBQzdCLEVBUWlCLEVEdUNMWCxDQUFNLEdBQUdkLEtBQ2R1QixZQUNMWixRQUFRQyxJQUFJLEdBQUdaLFdBQ1IsQ0FFWCxDQUVBLE1BQU8sQ0FDTEQsWUFDQTJCLFVBM0lGLFNBQW1CQyxFQUFLQyxFQUFLbEIsRUFBTW1CLEdBQ2pDLElBQ0V2QixFQUFnQnFCLEtBQ2hCckIsRUFBZ0JzQixJQUNRLEtBQXhCN0IsRUFBVTRCLEdBQUtDLEdBaUNmLE9BQU8sRUEvQlAsR0FBa0IsYUFBZEMsR0FBNEJ2QixFQUFnQnFCLEVBQU1qQixFQUFLaEIsT0FBUyxHQUNsRSxJQUFLLElBQUlRLEVBQUl5QixFQUFLekIsRUFBSXlCLEVBQU1qQixFQUFLaEIsT0FBUVEsSUFBSyxDQUM1QyxHQUEwQixLQUF0QkgsRUFBVUcsR0FBRzBCLEdBUVYsT0FBTyxFQVBaN0IsRUFBVUcsR0FBRzBCLEdBQU8sQ0FDbEI5QixLQUFNLEdBQUdZLEVBQUtoQixhQUNkZ0IsS0FBTUEsRUFDTm9CLE1BQU8sSUFDUHJDLFFBQVEsR0FFVlksRUFBTTBCLEtBQUtoQyxFQUFVRyxHQUFHMEIsR0FFNUIsQ0FHRixHQUNnQixlQUFkQyxHQUNBdkIsRUFBZ0JzQixFQUFNbEIsRUFBS2hCLE9BQVMsR0FFcEMsSUFBSyxJQUFJUSxFQUFJMEIsRUFBSzFCLEVBQUkwQixFQUFNbEIsRUFBS2hCLE9BQVFRLElBQUssQ0FDNUMsR0FBMEIsS0FBdEJILEVBQVU0QixHQUFLekIsR0FRWixPQUFPLEVBUFpILEVBQVU0QixHQUFLekIsR0FBSyxDQUNsQkosS0FBTSxHQUFHWSxFQUFLaEIsYUFDZGdCLEtBQU1BLEVBQ05vQixNQUFPLElBQ1ByQyxRQUFRLEdBRVZZLEVBQU0wQixLQUFLaEMsRUFBVTRCLEdBQUt6QixHQUU5QixDQU1KLE9BQU9ILENBQ1QsRUFtR0VpQyxjQS9GRixTQUF1QkwsRUFBS0MsR0FDMUIsSUFBSXRCLEVBQWdCcUIsS0FBUXJCLEVBQWdCc0IsS0FBeUIsSUFBbkJwQixJQW1CaEQsT0FBT0csUUFBUUMsSUFBSSx1QkFuQnNELENBQ3pFLElBQUlxQixFQUFZbEMsRUFBVTRCLEdBQUtDLEdBQy9CLEdBQWtCLE1BQWRLLEVBQ0YsT0FDdUIsS0FBZEEsR0FDVGxDLEVBQVU0QixHQUFLQyxHQUFPLElBQ3RCakIsUUFBUUMsSUFBSSxTQUNpQixNQUFwQnFCLEVBQVVILFFBQ25CRyxFQUFVdkIsS0FBS2xCLE1BQ2Z5QyxFQUFVSCxNQUFRLElBQ2RHLEVBQVV2QixLQUFLakIsV0FDakJ3QyxFQUFVeEMsUUFBUyxFQUVuQmtCLFFBQVFDLElBQUksU0FFZEQsUUFBUUMsSUFBSXFCLEVBQVV4QyxRQUN0QmUsSUFFSixDQUdGLEVBMEVFQSxlQUNELEVEckttQjBCLENBQVVyQyxLR0RoQyxJQUFJc0MsRUNGSnBCLFNBQVNHLGlCQUFpQixvQkFBb0IsTURHOUMsV0FDSSxNQUFNa0IsRUFBaUJyQixTQUFTQyxjQUFjLGtCQUN4Q3FCLEVBQW1CdEIsU0FBU0MsY0FBYyxrQkFFMUNzQixFQUFhMUMsRUFBTyxPQUNwQjJDLEVBQWEzQyxFQUFPLFlBRXBCNEMsRUFBV25ELEVBQUssR0FDaEJvRCxFQUFlcEQsRUFBSyxHQUNwQnFELEVBQWVyRCxFQUFLLEdBQ3BCc0QsRUFBYXRELEVBQUssR0FDbEJ1RCxFQUFhdkQsRUFBSyxHQUNsQndELEVBQWV4RCxFQUFLLEdBQ3BCeUQsRUFBYXpELEVBQUssR0FDbEIwRCxFQUFhMUQsRUFBSyxHQUNsQjJELEVBQWUzRCxFQUFLLEdBQ3BCNEQsRUFBYzVELEVBQUssR0FFbkJnQixFQUFRLENBQUNtQyxFQUFVQyxFQUFjQyxFQUFjQyxFQUFXQyxFQUFZQyxFQUFjQyxFQUFZQyxFQUFZQyxFQUFjQyxJQWdCaEksU0FBb0JsRCxHQUdoQixJQUFJbUQsRUFoQkdDLEtBQUtDLFNBQVcsR0FjSixhQUNGLFdBR2pCL0MsRUFBTWdELFNBQVMzQyxJQUNYLElBQUk0QyxHQUFhLEVBQ2pCLE1BQVFBLEdBQVksQ0FDaEIsSUFBSTNCLEVBQU13QixLQUFLSSxNQUFzQixHQUFoQkosS0FBS0MsVUFDdEJ4QixFQUFNdUIsS0FBS0ksTUFBc0IsR0FBaEJKLEtBQUtDLFVBRVgsSUFERnJELEVBQVVBLFVBQVUyQixVQUFVQyxFQUFLQyxFQUFLbEIsRUFBTXdDLEtBRXZESSxHQUFhLEVBRXJCLElBRVIsQ0FHQUUsQ0FBV2xCLEdBWVhDLEVBQVd4QyxVQUFVMkIsVUFBVSxFQUFFLEVBQUdjLEVBQVUsY0FDOUNELEVBQVd4QyxVQUFVMkIsVUFBVSxFQUFFLEVBQUdlLEVBQWMsY0FDbERGLEVBQVd4QyxVQUFVMkIsVUFBVSxFQUFFLEVBQUdnQixFQUFjLFlBQ2xESCxFQUFXeEMsVUFBVTJCLFVBQVUsRUFBRSxFQUFHaUIsRUFBWSxjQUNoREosRUFBV3hDLFVBQVUyQixVQUFVLEVBQUUsRUFBR2tCLEVBQVksWUFDaERMLEVBQVd4QyxVQUFVMkIsVUFBVSxFQUFFLEVBQUdtQixFQUFjLGNBQ2xETixFQUFXeEMsVUFBVTJCLFVBQVUsRUFBRSxFQUFHb0IsRUFBWSxjQUNoRFAsRUFBV3hDLFVBQVUyQixVQUFVLEVBQUUsRUFBR3FCLEVBQVksY0FDaERSLEVBQVd4QyxVQUFVMkIsVUFBVSxFQUFFLEVBQUdzQixFQUFjLGNBQ2xEVCxFQUFXeEMsVUFBVTJCLFVBQVUsRUFBRSxFQUFHdUIsRUFBYSxjQUdqRGQsRURoRkosU0FBK0JuQyxFQUFReUQsR0FDbkMsTUFBTUMsRUFBWTNDLFNBQVM0QyxjQUFjLE9BRXpDLFNBQVNDLElBQ0xGLEVBQVVsQyxZQUFjLEdBQ3hCLElBQUssSUFBSXRCLEVBQUksRUFBR0EsRUFBSUYsRUFBT0QsVUFBVUEsVUFBVUwsT0FBUVEsSUFDbkQsSUFBSyxJQUFJQyxFQUFJLEVBQUdBLEVBQUlILEVBQU9ELFVBQVVBLFVBQVVHLEdBQUdSLE9BQVFTLElBQUssQ0FDM0QsTUFBTTBELEVBQVM5QyxTQUFTNEMsY0FBYyxPQUNVLGlCQUF0QzNELEVBQU9ELFVBQVVBLFVBQVVHLEdBQUdDLElBQ2pDSCxFQUFPRCxVQUFVQSxVQUFVRyxHQUFHQyxHQUFHMkIsTUFBUSxPQUN4QytCLEVBQU9DLFVBQVk5RCxFQUFPRCxVQUFVQSxVQUFVRyxHQUFHQyxHQUFHMkIsTUFDcEQrQixFQUFPMUMsVUFBVUMsSUFBSSxVQUVtQixNQUFyQ3BCLEVBQU9ELFVBQVVBLFVBQVVHLEdBQUdDLElBQ3JDMEQsRUFBT0MsVUFBWTlELEVBQU9ELFVBQVVBLFVBQVVHLEdBQUdDLEdBQ2pEMEQsRUFBTzFDLFVBQVVDLElBQUksV0FHckJ5QyxFQUFPQyxVQUFZOUQsRUFBT0QsVUFBVUEsVUFBVUcsR0FBR0MsR0FFckR1RCxFQUFVSyxZQUFZRixFQUMxQixDQUVKSixFQUFJTyxPQUFPTixFQUNmLENBa0NBLE9BeERBQSxFQUFVdkMsVUFBVUMsSUFBSSxhQXdEakIsQ0FDSHdDLFNBQ0FLLE9BaENKLFNBQVNBLEVBQU9DLEVBQVUsR0FDdEIsR0FBSUEsR0FIYSxHQUtiLFlBREF2RCxRQUFRQyxJQUFJLHNEQUloQixJQUFJdUQsRUFBWWhCLEtBQUtJLE1BQXNCLEdBQWhCSixLQUFLQyxVQUM1QmdCLEVBQVlqQixLQUFLSSxNQUFzQixHQUFoQkosS0FBS0MsVUFFaEMsR0FDeUQsTUFBckRwRCxFQUFPRCxVQUFVQSxVQUFVb0UsR0FBV0MsSUFDcUIsTUFBM0RwRSxFQUFPRCxVQUFVQSxVQUFVb0UsR0FBV0MsR0FBV3RDLE9BQ0ksTUFBckQ5QixFQUFPRCxVQUFVQSxVQUFVb0UsR0FBV0MsR0FHdEMsT0FEQXBFLEVBQU9ELFVBQVVpQyxjQUFjbUMsRUFBV0MsR0FDc0IsaUJBQXJEcEUsRUFBT0QsVUFBVUEsVUFBVW9FLEdBQVdDLElBQzdDcEUsRUFBT0QsVUFBVUEsVUFBVW9FLEdBQVdDLEdBQWFwRSxFQUFPRCxVQUFVQSxVQUFVb0UsR0FBV0MsR0FBV3RDLE1BQ3BHdUMsV0FBV0osRUFBTyxVQUNsQkwsVUFHQUEsSUFJSkssRUFBT0MsRUFBVSxFQUV6QixFQU9KLENDa0JzQkksQ0FBc0JoQyxFQUFZRixHRGhCeEQsU0FBOEJwQyxFQUFReUQsR0FDbEMsTUFBTUMsRUFBWTNDLFNBQVM0QyxjQUFjLE9BQ3pDRCxFQUFVdkMsVUFBVUMsSUFBSSxhQUN4QixJQUFLLElBQUlsQixFQUFJLEVBQUdBLEVBQUlGLEVBQU9ELFVBQVVBLFVBQVVMLE9BQVFRLElBQ25ELElBQUssSUFBSUMsRUFBSSxFQUFHQSxFQUFJSCxFQUFPRCxVQUFVQSxVQUFVRyxHQUFHUixPQUFRUyxJQUFLLENBQzNELE1BQU0wRCxFQUFTOUMsU0FBUzRDLGNBQWMsT0FTdENELEVBQVVLLFlBQVlGLEdBQ3RCQSxFQUFPM0MsaUJBQWlCLFNBQVMsS0FDN0JsQixFQUFPRCxVQUFVaUMsY0FBYyxDQUFDOUIsR0FBRyxDQUFDQyxJQUNZLGlCQUF0Q0gsRUFBT0QsVUFBVUEsVUFBVUcsR0FBR0MsSUFDcEMwRCxFQUFPQyxVQUFZOUQsRUFBT0QsVUFBVUEsVUFBVUcsR0FBR0MsR0FBRzJCLE1BQ3BEK0IsRUFBTzFDLFVBQVVDLElBQUksWUFFckJ5QyxFQUFPQyxVQUFZOUQsRUFBT0QsVUFBVUEsVUFBVUcsR0FBR0MsR0FDakRrRSxXQUFXbEMsRUFBZ0I4QixPQUFPLEtBQ2xDOUIsRUFBZ0J5QixTQUNwQixHQUVSLENBRUpILEVBQUlPLE9BQU9OLEVBQ2YsQ0NaSWEsQ0FBb0JoQyxFQUFZRixHQUVoQ0YsRUFBZ0J5QixRQUVwQixDQ3BGSVksRUFBUyxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9zaGlwLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvcGxheWVyLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZ2FtZWJvYXJkLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvVUkuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9nYW1lLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgU2hpcCA9IChzaGlwTGVuZ3RoKSA9PiB7XG4gIGNvbnN0IGxlbmd0aCA9IHNoaXBMZW5ndGg7XG4gIGxldCBoaXRzID0gMDtcblxuICBmdW5jdGlvbiBoaXQoKSB7XG4gICAgaGl0cyArPSAxO1xuICB9XG5cbiAgZnVuY3Rpb24gaXNTdW5rKCkge1xuICAgIGlmIChzaGlwTGVuZ3RoIDw9IGhpdHMpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSByZXR1cm4gZmFsc2U7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGhpdCxcbiAgICBpc1N1bmssXG4gICAgbGVuZ3RoLFxuICAgIGdldEhpdHM6ICgpID0+IGhpdHMsXG4gIH07XG59O1xuXG5leHBvcnQgeyBTaGlwIH07XG4iLCJpbXBvcnQgeyBHYW1lYm9hcmQgfSBmcm9tIFwiLi9nYW1lYm9hcmRcIlxyXG5cclxuY29uc3QgUGxheWVyID0gKHBsYXllcnR5cGUpID0+IHtcclxuICAgIGNvbnN0IHR5cGUgPSBwbGF5ZXJ0eXBlO1xyXG5cclxuICAgIGNvbnN0IGdhbWVib2FyZCA9IEdhbWVib2FyZChwbGF5ZXJ0eXBlKTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHR5cGUsXHJcbiAgICAgICAgZ2FtZWJvYXJkXHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCB7UGxheWVyfVxyXG4iLCJpbXBvcnQgeyBTaGlwIH0gZnJvbSBcIi4vc2hpcFwiO1xuaW1wb3J0IHsgbW9kYWwgfSBmcm9tIFwiLi9VSVwiO1xuXG5jb25zdCBHYW1lYm9hcmQgPSAocGxheWVyKSA9PiB7XG4gIGZ1bmN0aW9uIGNyZWF0ZUdhbWVCb2FyZCgpIHtcbiAgICBjb25zdCBnYW1lQm9hcmQgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8PSA5OyBpKyspIHtcbiAgICAgIGdhbWVCb2FyZFtpXSA9IFtdO1xuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPD0gOTsgaisrKSB7XG4gICAgICAgIGdhbWVCb2FyZFtpXVtqXSA9IFwiXCI7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBnYW1lQm9hcmQ7XG4gIH1cblxuICBjb25zdCBnYW1lYm9hcmQgPSBjcmVhdGVHYW1lQm9hcmQoKTtcbiAgY29uc3Qgc2hpcHMgPSBbXTtcblxuICBmdW5jdGlvbiBfaXNXaXRoaW5Cb3VuZHMoaW5kZXgpIHtcbiAgICBpZiAoaW5kZXggPCAwIHx8IGluZGV4ID4gOSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICAvL3N0YXJ0IGFuZCBlbmQgaGVyZSAtIGluZGV4ZXMgb2YgdGhlIGJvcmQncyBjZWxscyB3aGVyZSBpIHdhbnQgdG8gcGxhY2Ugc2hpcFxuICAvLyB0aGUgY29vcmRpbmF0ZSBvYmplY3Qgc2hvdWxkIGhhdmUgYSByZWZlcmVuY2UgdG8gdGhlIHNoaXAgaW4gaXRzIGxvY2F0aW9uLlxuICBmdW5jdGlvbiBwbGFjZVNoaXAoY29sLCByb3csIHNoaXAsIGRpcmVjdGlvbikge1xuICAgIGlmIChcbiAgICAgIF9pc1dpdGhpbkJvdW5kcyhjb2wpICYmXG4gICAgICBfaXNXaXRoaW5Cb3VuZHMocm93KSAmJlxuICAgICAgZ2FtZWJvYXJkW2NvbF1bcm93XSA9PT0gXCJcIlxuICAgICkge1xuICAgICAgaWYgKGRpcmVjdGlvbiA9PT0gXCJ2ZXJ0aWNhbFwiICYmIF9pc1dpdGhpbkJvdW5kcyhjb2wgKyBzaGlwLmxlbmd0aCAtIDEpKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSBjb2w7IGkgPCBjb2wgKyBzaGlwLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgaWYgKGdhbWVib2FyZFtpXVtyb3ddID09PSBcIlwiKSB7XG4gICAgICAgICAgICBnYW1lYm9hcmRbaV1bcm93XSA9IHtcbiAgICAgICAgICAgICAgdHlwZTogYCR7c2hpcC5sZW5ndGh9c2hpcGAsXG4gICAgICAgICAgICAgIHNoaXA6IHNoaXAsXG4gICAgICAgICAgICAgIHZhbHVlOiBcIk9cIixcbiAgICAgICAgICAgICAgaXNTdW5rOiBmYWxzZSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBzaGlwcy5wdXNoKGdhbWVib2FyZFtpXVtyb3ddKTtcbiAgICAgICAgICB9IGVsc2UgcmV0dXJuIDI7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKFxuICAgICAgICBkaXJlY3Rpb24gPT09IFwiaG9yaXpvbnRhbFwiICYmXG4gICAgICAgIF9pc1dpdGhpbkJvdW5kcyhyb3cgKyBzaGlwLmxlbmd0aCAtIDEpXG4gICAgICApIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IHJvdzsgaSA8IHJvdyArIHNoaXAubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBpZiAoZ2FtZWJvYXJkW2NvbF1baV0gPT09IFwiXCIpIHtcbiAgICAgICAgICAgIGdhbWVib2FyZFtjb2xdW2ldID0ge1xuICAgICAgICAgICAgICB0eXBlOiBgJHtzaGlwLmxlbmd0aH1zaGlwYCxcbiAgICAgICAgICAgICAgc2hpcDogc2hpcCxcbiAgICAgICAgICAgICAgdmFsdWU6IFwiT1wiLFxuICAgICAgICAgICAgICBpc1N1bms6IGZhbHNlLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHNoaXBzLnB1c2goZ2FtZWJvYXJkW2NvbF1baV0pO1xuICAgICAgICAgIH0gZWxzZSByZXR1cm4gMjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gMjtcbiAgICB9XG5cbiAgICByZXR1cm4gZ2FtZWJvYXJkO1xuICB9XG4gIFxuXG4gIC8vQ3VycmVudGx5IHRlc3RpbmcgdGhpcyBpbiBpbmRleC5qc1xuICBmdW5jdGlvbiByZWNlaXZlQXR0YWNrKGNvbCwgcm93KSB7XG4gICAgaWYgKF9pc1dpdGhpbkJvdW5kcyhjb2wpICYmIF9pc1dpdGhpbkJvdW5kcyhyb3cpJiZjaGVja0VuZEdhbWUoKSAhPT0gdHJ1ZSkge1xuICAgICAgbGV0IGJvYXJkQ2VsbCA9IGdhbWVib2FyZFtjb2xdW3Jvd107XG4gICAgICBpZiAoYm9hcmRDZWxsID09PSAnXFx1MjVDRicpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSBlbHNlIGlmIChib2FyZENlbGwgPT09IFwiXCIpIHtcbiAgICAgICAgZ2FtZWJvYXJkW2NvbF1bcm93XSA9ICdcXHUyNUNGJztcbiAgICAgICAgY29uc29sZS5sb2coXCJNaXNzXCIpO1xuICAgICAgfSBlbHNlIGlmIChib2FyZENlbGwudmFsdWUgPT09IFwiT1wiKSB7XG4gICAgICAgIGJvYXJkQ2VsbC5zaGlwLmhpdCgpO1xuICAgICAgICBib2FyZENlbGwudmFsdWUgPSBcIlhcIjtcbiAgICAgICAgaWYgKGJvYXJkQ2VsbC5zaGlwLmlzU3VuaygpKSB7XG4gICAgICAgICAgYm9hcmRDZWxsLmlzU3VuayA9IHRydWU7XG4gICAgICAgICAgLy8gX21hcmtDZWxsc0Fyb3VuZFN1Y2NzZXNzZnVsbEhpdChjb2wsIHJvdyk7XG4gICAgICAgICAgY29uc29sZS5sb2coXCJTdW5rXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnNvbGUubG9nKGJvYXJkQ2VsbC5pc1N1bmspO1xuICAgICAgICBjaGVja0VuZEdhbWUoKVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gY29uc29sZS5sb2coXCJBdHRhY2sgb3V0IG9mIGJvYXJkXCIpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIF9tYXJrQ2VsbHNBcm91bmRTdWNjc2Vzc2Z1bGxIaXQoY29sLCByb3cpIHtcbiAgICBjb25zdCBuZWlnaGJvdXJzID0gW1xuICAgICAgZ2FtZWJvYXJkW2NvbCArIDFdPy5bcm93XSxcbiAgICAgIGdhbWVib2FyZFtjb2wgLSAxXT8uW3Jvd10sXG4gICAgICBnYW1lYm9hcmRbY29sXT8uW3JvdyArIDFdLFxuICAgICAgZ2FtZWJvYXJkW2NvbF0/Lltyb3cgLSAxXSxcbiAgICAgIGdhbWVib2FyZFtjb2wgKyAxXT8uW3JvdyArIDFdLFxuICAgICAgZ2FtZWJvYXJkW2NvbCAtIDFdPy5bcm93IC0gMV0sXG4gICAgICBnYW1lYm9hcmRbY29sIC0gMV0/Lltyb3cgKyAxXSxcbiAgICAgIGdhbWVib2FyZFtjb2wgKyAxXT8uW3JvdyAtIDFdLFxuICAgIF07XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5laWdoYm91cnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChcbiAgICAgICAgbmVpZ2hib3Vyc1tpXSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgIG5laWdoYm91cnNbaV0udmFsdWUgIT09IFwiT1wiICYmXG4gICAgICAgIG5laWdoYm91cnNbaV0udmFsdWUgIT09IFwiWFwiXG4gICAgICApIHtcbiAgICAgICAgbmVpZ2hib3Vyc1tpXSA9ICdcXHUyNUNGJztcbiAgICAgICAgLy8gVXBkYXRlIGNvcnJlc3BvbmRpbmcgdmFsdWUgaW4gZ2FtZWJvYXJkIGFycmF5XG4gICAgICAgIHN3aXRjaCAoaSkge1xuICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIGdhbWVib2FyZFtjb2wgKyAxXVtyb3ddID0gJ1xcdTI1Q0YnO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgZ2FtZWJvYXJkW2NvbCAtIDFdW3Jvd10gPSAnXFx1MjVDRic7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICBnYW1lYm9hcmRbY29sXVtyb3cgKyAxXSA9ICdcXHUyNUNGJztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgIGdhbWVib2FyZFtjb2xdW3JvdyAtIDFdID0gJ1xcdTI1Q0YnO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgZ2FtZWJvYXJkW2NvbCArIDFdW3JvdyArIDFdID0gJ1xcdTI1Q0YnO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgZ2FtZWJvYXJkW2NvbCAtIDFdW3JvdyAtIDFdID0gJ1xcdTI1Q0YnO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgZ2FtZWJvYXJkW2NvbCAtIDFdW3JvdyArIDFdID0gJ1xcdTI1Q0YnO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgZ2FtZWJvYXJkW2NvbCArIDFdW3JvdyAtIDFdID0gJ1xcdTI1Q0YnO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gY2hlY2tFbmRHYW1lKCkge1xuICAgIGxldCBjb3VudGVyID0gMDtcbiAgICBmb3IgKGxldCBzaGlwIG9mIHNoaXBzKSB7XG4gICAgICBpZiAoc2hpcC5pc1N1bmsgPT09IHRydWUpIHtcbiAgICAgICAgY291bnRlcisrO1xuICAgICAgfVxuICAgIH1cbiAgICBjb25zb2xlLmxvZyhjb3VudGVyKTtcbiAgICBpZiAoY291bnRlciA+PSAxMCkge1xuICAgICAgbGV0IG5ld3M9IG1vZGFsKGAke3BsYXllcn1gKTtcbiAgICAgIG5ld3Mub3Blbk1vZGFsKClcbiAgICAgIGNvbnNvbGUubG9nKGAke3BsYXllcn0gbG9zZWApO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBnYW1lYm9hcmQsXG4gICAgcGxhY2VTaGlwLFxuICAgIHJlY2VpdmVBdHRhY2ssXG4gICAgY2hlY2tFbmRHYW1lLFxuICB9O1xufTtcblxuZXhwb3J0IHsgR2FtZWJvYXJkIH07XG4iLCJpbXBvcnQgeyBwbGF5ZXJHYW1lYm9hcmQgfSBmcm9tIFwiLi9nYW1lXCI7XHJcblxyXG5mdW5jdGlvbiByZW5kZXJQbGF5ZXJHYW1lYm9hcmQocGxheWVyLCBib3gpIHtcclxuICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2NvbnRhaW5lcicpXHJcbiAgICBmdW5jdGlvbiByZW5kZXIoKSB7ICAgXHJcbiAgICAgICAgY29udGFpbmVyLnRleHRDb250ZW50ID0gJyc7IFxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGxheWVyLmdhbWVib2FyZC5nYW1lYm9hcmQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBwbGF5ZXIuZ2FtZWJvYXJkLmdhbWVib2FyZFtpXS5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc3F1YXJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgICAgICBpZih0eXBlb2YocGxheWVyLmdhbWVib2FyZC5nYW1lYm9hcmRbaV1bal0pID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHBsYXllci5nYW1lYm9hcmQuZ2FtZWJvYXJkW2ldW2pdLnZhbHVlID0gJ08nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNxdWFyZS5pbm5lckhUTUwgPSBwbGF5ZXIuZ2FtZWJvYXJkLmdhbWVib2FyZFtpXVtqXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoJ2JsYWNrJylcclxuICAgICAgICAgICAgICAgICAgICB9IFxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwbGF5ZXIuZ2FtZWJvYXJkLmdhbWVib2FyZFtpXVtqXSA9PT0gXCJYXCIpe1xyXG4gICAgICAgICAgICAgICAgICAgIHNxdWFyZS5pbm5lckhUTUwgPSBwbGF5ZXIuZ2FtZWJvYXJkLmdhbWVib2FyZFtpXVtqXTsgXHJcbiAgICAgICAgICAgICAgICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoJ29yYW5nZScpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBzcXVhcmUuaW5uZXJIVE1MID0gcGxheWVyLmdhbWVib2FyZC5nYW1lYm9hcmRbaV1bal07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoc3F1YXJlKTtcclxuICAgICAgICAgICAgfSAgIFxyXG4gICAgICAgIH1cclxuICAgICAgICBib3guYXBwZW5kKGNvbnRhaW5lcilcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBNQVhfQVRURU1QVFMgPSA5OTtcclxuXHJcbiAgICBmdW5jdGlvbiBhdHRhY2soYXR0ZW1wdCA9IDApIHtcclxuICAgICAgICBpZiAoYXR0ZW1wdCA+PSBNQVhfQVRURU1QVFMpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJNYXhpbXVtIGF0dGVtcHRzIHJlYWNoZWQuIEV4aXRpbmcgYXR0YWNrIGZ1bmN0aW9uLlwiKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBsZXQgY29sUmFuZG9tID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xyXG4gICAgICAgIGxldCByb3dSYW5kb20gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XHJcbiAgICBcclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIHBsYXllci5nYW1lYm9hcmQuZ2FtZWJvYXJkW2NvbFJhbmRvbV1bcm93UmFuZG9tXSAhPT0gJ1xcdTI1Q0YnICYmXHJcbiAgICAgICAgICAgIHBsYXllci5nYW1lYm9hcmQuZ2FtZWJvYXJkW2NvbFJhbmRvbV1bcm93UmFuZG9tXS52YWx1ZSAhPT0gJ1gnICYmXHJcbiAgICAgICAgICAgIHBsYXllci5nYW1lYm9hcmQuZ2FtZWJvYXJkW2NvbFJhbmRvbV1bcm93UmFuZG9tXSAhPT0gJ1gnXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIHBsYXllci5nYW1lYm9hcmQucmVjZWl2ZUF0dGFjayhjb2xSYW5kb20sIHJvd1JhbmRvbSk7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgcGxheWVyLmdhbWVib2FyZC5nYW1lYm9hcmRbY29sUmFuZG9tXVtyb3dSYW5kb21dID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgICAgICAgICAgcGxheWVyLmdhbWVib2FyZC5nYW1lYm9hcmRbY29sUmFuZG9tXVtyb3dSYW5kb21dID0gcGxheWVyLmdhbWVib2FyZC5nYW1lYm9hcmRbY29sUmFuZG9tXVtyb3dSYW5kb21dLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChhdHRhY2ssMTAwMClcclxuICAgICAgICAgICAgICAgIHJlbmRlcigpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmVuZGVyKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBhdHRhY2soYXR0ZW1wdCArIDEpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICByZW5kZXIsXHJcbiAgICAgICAgYXR0YWNrXHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbmRlckNvbXBHYW1lYm9hcmQgKHBsYXllciwgYm94KSB7XHJcbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdjb250YWluZXInKVxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwbGF5ZXIuZ2FtZWJvYXJkLmdhbWVib2FyZC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgcGxheWVyLmdhbWVib2FyZC5nYW1lYm9hcmRbaV0ubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgY29uc3Qgc3F1YXJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIC8vQ29tZW50ZWQgZm9yIGNoZWNraW5nIHJhbmRvbSBzaGlwIHBsYWNlbWVudCBvbiBjb21wIGJvYXJkXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBpZih0eXBlb2YocGxheWVyLmdhbWVib2FyZC5nYW1lYm9hcmRbaV1bal0pID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgICAgICAvLyAgICAgaWYocGxheWVyLmdhbWVib2FyZC5nYW1lYm9hcmRbaV1bal0udmFsdWUgPSAnTycpIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICBzcXVhcmUuaW5uZXJIVE1MID0gcGxheWVyLmdhbWVib2FyZC5nYW1lYm9hcmRbaV1bal0udmFsdWU7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoJ2JsYWNrJylcclxuICAgICAgICAgICAgLy8gICAgIH0gXHJcbiAgICAgICAgICAgIC8vIH0gXHJcbiAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChzcXVhcmUpO1xyXG4gICAgICAgICAgICBzcXVhcmUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBwbGF5ZXIuZ2FtZWJvYXJkLnJlY2VpdmVBdHRhY2soW2ldLFtqXSlcclxuICAgICAgICAgICAgICAgIGlmKHR5cGVvZihwbGF5ZXIuZ2FtZWJvYXJkLmdhbWVib2FyZFtpXVtqXSkgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3F1YXJlLmlubmVySFRNTCA9IHBsYXllci5nYW1lYm9hcmQuZ2FtZWJvYXJkW2ldW2pdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKCdvcmFuZ2UnKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3F1YXJlLmlubmVySFRNTCA9IHBsYXllci5nYW1lYm9hcmQuZ2FtZWJvYXJkW2ldW2pdO1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQocGxheWVyR2FtZWJvYXJkLmF0dGFjaywxMDAwKTtcclxuICAgICAgICAgICAgICAgICAgICBwbGF5ZXJHYW1lYm9hcmQucmVuZGVyKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBib3guYXBwZW5kKGNvbnRhaW5lcik7XHJcbn1cclxuXHJcbmNvbnN0IG1vZGFsID0gKGxvc2VyKSA9PiB7XHJcbiAgICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxcIik7XHJcbiAgICBjb25zdCBvdmVybGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5vdmVybGF5XCIpO1xyXG4gICAgY29uc3QgbmV3R2FtZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYnRuXCIpO1xyXG4gICAgbmV3R2FtZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICBjbG9zZU1vZGFsKClcclxuICAgIH0pXHJcblxyXG5cclxuICAgIGZ1bmN0aW9uIG9wZW5Nb2RhbCgpIHtcclxuICAgICAgICBjb25zdCB3aW5NYXNzYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLndpbicpO1xyXG4gICAgICAgIHdpbk1hc3NhZ2UudGV4dENvbnRlbnQgPSBgJHtsb3Nlcn0gbG9zdCFgXHJcbiAgICAgICAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcclxuICAgICAgICBvdmVybGF5LmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRkZW5cIik7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBmdW5jdGlvbiBjbG9zZU1vZGFsKCkge1xyXG4gICAgICAgIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XHJcbiAgICAgICAgb3ZlcmxheS5jbGFzc0xpc3QuYWRkKFwiaGlkZGVuXCIpO1xyXG4gICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpXHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiB7b3Blbk1vZGFsfVxyXG59XHJcblxyXG5cclxuXHJcblxyXG5leHBvcnQge1xyXG4gICAgcmVuZGVyUGxheWVyR2FtZWJvYXJkLFxyXG4gICAgcmVuZGVyQ29tcEdhbWVib2FyZCxcclxuICAgIG1vZGFsXHJcbn0iLCJpbXBvcnQgeyBTaGlwIH0gZnJvbSBcIi4vc2hpcFwiO1xyXG5pbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi9wbGF5ZXJcIjtcclxuaW1wb3J0IHsgcmVuZGVyUGxheWVyR2FtZWJvYXJkLCByZW5kZXJDb21wR2FtZWJvYXJkIH0gZnJvbSBcIi4vVUlcIjtcclxuXHJcbmxldCBwbGF5ZXJHYW1lYm9hcmRcclxuZnVuY3Rpb24gcGxheUdhbWUgKCkgeyBcclxuICAgIGNvbnN0IHBsYXllckJvYXJkQm94ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmdhbWVib2FyZC1vbmUnKTtcclxuICAgIGNvbnN0IGNvbXB1dGVyQm9hcmRCb3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ2FtZWJvYXJkLXR3bycpO1xyXG5cclxuICAgIGNvbnN0IHJlYWxQbGF5ZXIgPSBQbGF5ZXIoJ1lvdScpO1xyXG4gICAgY29uc3QgY29tcFBsYXllciA9IFBsYXllcignQ29tcHV0ZXInKTtcclxuXHJcbiAgICBjb25zdCBmb3VyU2hpcCA9IFNoaXAoNClcclxuICAgIGNvbnN0IHRocmVlU2hpcE9uZSA9IFNoaXAoMyk7XHJcbiAgICBjb25zdCB0aHJlZVNoaXBUd28gPSBTaGlwKDMpO1xyXG4gICAgY29uc3QgdHdvU2hpcE9uZSA9IFNoaXAoMik7XHJcbiAgICBjb25zdCB0d29TaGlwVHdvID0gU2hpcCgyKTtcclxuICAgIGNvbnN0IHR3b1NoaXBUaHJlZSA9IFNoaXAoMik7XHJcbiAgICBjb25zdCBvbmVTaGlwT25lID0gU2hpcCgxKTtcclxuICAgIGNvbnN0IG9uZVNoaXBUd28gPSBTaGlwKDEpO1xyXG4gICAgY29uc3Qgb25lU2hpcFRocmVlID0gU2hpcCgxKTtcclxuICAgIGNvbnN0IG9uZVNoaXBGb3VyID0gU2hpcCgxKTtcclxuXHJcbiAgICBjb25zdCBzaGlwcyA9IFtmb3VyU2hpcCwgdGhyZWVTaGlwT25lLCB0aHJlZVNoaXBUd28sIHR3b1NoaXBPbmUsdHdvU2hpcFR3bywgdHdvU2hpcFRocmVlLCBvbmVTaGlwT25lLCBvbmVTaGlwVHdvLCBvbmVTaGlwVGhyZWUsIG9uZVNoaXBGb3VyXVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldFJhbmRvbVN0cmluZyhzdHJpbmcxLCBzdHJpbmcyKSB7XHJcbiAgICAgICAgcmV0dXJuIE1hdGgucmFuZG9tKCkgPCAwLjUgPyBzdHJpbmcxIDogc3RyaW5nMjtcclxuICAgIH1cclxuICAgIC8vIGZ1bmN0aW9uIHJlbmRlclNoaXAoZ2FtZWJvYXJkLCBjb2wsIHJvdykge1xyXG4gICAgLy8gICAgIGNvbnN0IGhvcml6b250YWwgPSAnaG9yaXpvbnRhbCc7XHJcbiAgICAvLyAgICAgY29uc3QgdmVydGljYWwgPSAndmVydGljYWwnO1xyXG4gICAgLy8gICAgIGxldCBvcmllbnRhdGlvbiA9IGdldFJhbmRvbVN0cmluZyhob3Jpem9udGFsLHZlcnRpY2FsKVxyXG4gICAgLy8gICAgIHNoaXBzLmZvckVhY2goKHNoaXApPT4ge1xyXG4gICAgLy8gICAgICAgICBnYW1lYm9hcmQuZ2FtZWJvYXJkLnBsYWNlU2hpcChjb2wsIHJvdywgc2hpcCwgb3JpZW50YXRpb24pXHJcbiAgICAvLyAgICAgfSlcclxuICAgIC8vIH1cclxuXHJcbiAgICAvL1JlbmRlcnMgYWxsIHNoaXBzIGJ1dCB0aGUgc2hpcHMgdG91Y2ggZWFjaCBvdGhlciBvbiB0aGUgYm9hcmQgXHJcbiAgICAvL05lZWQgdG8gdXBkYXRlIHBsYWNlU2hpcFxyXG4gICAgZnVuY3Rpb24gcmVuZGVyU2hpcChnYW1lYm9hcmQpIHtcclxuICAgICAgICBjb25zdCBob3Jpem9udGFsID0gJ2hvcml6b250YWwnO1xyXG4gICAgICAgIGNvbnN0IHZlcnRpY2FsID0gJ3ZlcnRpY2FsJztcclxuICAgICAgICBsZXQgb3JpZW50YXRpb24gPSBnZXRSYW5kb21TdHJpbmcoaG9yaXpvbnRhbCwgdmVydGljYWwpO1xyXG4gICAgXHJcbiAgICAgICAgc2hpcHMuZm9yRWFjaCgoc2hpcCkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgc2hpcFBsYWNlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB3aGlsZSAoIXNoaXBQbGFjZWQpIHtcclxuICAgICAgICAgICAgICAgIGxldCBjb2wgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7IFxyXG4gICAgICAgICAgICAgICAgbGV0IHJvdyA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTsgXHJcbiAgICAgICAgICAgICAgICBsZXQgcmVzdWx0ID0gZ2FtZWJvYXJkLmdhbWVib2FyZC5wbGFjZVNoaXAoY29sLCByb3csIHNoaXAsIG9yaWVudGF0aW9uKTtcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgIT09IDIpIHtcclxuICAgICAgICAgICAgICAgICAgICBzaGlwUGxhY2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcblxyXG4gICAgcmVuZGVyU2hpcChyZWFsUGxheWVyKVxyXG4gICAgLy8gcmVhbFBsYXllci5nYW1lYm9hcmQucGxhY2VTaGlwKDAsMCwgZm91clNoaXAsICdob3Jpem9udGFsJyk7XHJcbiAgICAvLyByZWFsUGxheWVyLmdhbWVib2FyZC5wbGFjZVNoaXAoOSw2LCB0aHJlZVNoaXBPbmUsICdob3Jpem9udGFsJyk7XHJcbiAgICAvLyByZWFsUGxheWVyLmdhbWVib2FyZC5wbGFjZVNoaXAoMCw5LCB0aHJlZVNoaXBUd28sICd2ZXJ0aWNhbCcpO1xyXG4gICAgLy8gcmVhbFBsYXllci5nYW1lYm9hcmQucGxhY2VTaGlwKDgsMCwgdHdvU2hpcE9uZSwgJ2hvcml6b250YWwnKTtcclxuICAgIC8vIHJlYWxQbGF5ZXIuZ2FtZWJvYXJkLnBsYWNlU2hpcCg1LDQsIHR3b1NoaXBUd28sICd2ZXJ0aWNhbCcpO1xyXG4gICAgLy8gcmVhbFBsYXllci5nYW1lYm9hcmQucGxhY2VTaGlwKDIsNiwgdHdvU2hpcFRocmVlLCAnaG9yaXpvbnRhbCcpO1xyXG4gICAgLy8gcmVhbFBsYXllci5nYW1lYm9hcmQucGxhY2VTaGlwKDgsNCwgb25lU2hpcE9uZSwgJ2hvcml6b250YWwnKTtcclxuICAgIC8vIHJlYWxQbGF5ZXIuZ2FtZWJvYXJkLnBsYWNlU2hpcCgyLDIsIG9uZVNoaXBUd28sICdob3Jpem9udGFsJyk7XHJcbiAgICAvLyByZWFsUGxheWVyLmdhbWVib2FyZC5wbGFjZVNoaXAoNiw4LCBvbmVTaGlwVGhyZWUsICdob3Jpem9udGFsJyk7XHJcbiAgICAvLyByZWFsUGxheWVyLmdhbWVib2FyZC5wbGFjZVNoaXAoNSwwLCBvbmVTaGlwRm91ciwgJ2hvcml6b250YWwnKTtcclxuXHJcbiAgICBjb21wUGxheWVyLmdhbWVib2FyZC5wbGFjZVNoaXAoMCwwLCBmb3VyU2hpcCwgJ2hvcml6b250YWwnKTtcclxuICAgIGNvbXBQbGF5ZXIuZ2FtZWJvYXJkLnBsYWNlU2hpcCg5LDYsIHRocmVlU2hpcE9uZSwgJ2hvcml6b250YWwnKTtcclxuICAgIGNvbXBQbGF5ZXIuZ2FtZWJvYXJkLnBsYWNlU2hpcCgwLDksIHRocmVlU2hpcFR3bywgJ3ZlcnRpY2FsJyk7XHJcbiAgICBjb21wUGxheWVyLmdhbWVib2FyZC5wbGFjZVNoaXAoOCwwLCB0d29TaGlwT25lLCAnaG9yaXpvbnRhbCcpO1xyXG4gICAgY29tcFBsYXllci5nYW1lYm9hcmQucGxhY2VTaGlwKDUsNCwgdHdvU2hpcFR3bywgJ3ZlcnRpY2FsJyk7XHJcbiAgICBjb21wUGxheWVyLmdhbWVib2FyZC5wbGFjZVNoaXAoMiw2LCB0d29TaGlwVGhyZWUsICdob3Jpem9udGFsJyk7XHJcbiAgICBjb21wUGxheWVyLmdhbWVib2FyZC5wbGFjZVNoaXAoOCw0LCBvbmVTaGlwT25lLCAnaG9yaXpvbnRhbCcpO1xyXG4gICAgY29tcFBsYXllci5nYW1lYm9hcmQucGxhY2VTaGlwKDIsMiwgb25lU2hpcFR3bywgJ2hvcml6b250YWwnKTtcclxuICAgIGNvbXBQbGF5ZXIuZ2FtZWJvYXJkLnBsYWNlU2hpcCg3LDgsIG9uZVNoaXBUaHJlZSwgJ2hvcml6b250YWwnKTtcclxuICAgIGNvbXBQbGF5ZXIuZ2FtZWJvYXJkLnBsYWNlU2hpcCg1LDAsIG9uZVNoaXBGb3VyLCAnaG9yaXpvbnRhbCcpO1xyXG5cclxuXHJcbiAgICBwbGF5ZXJHYW1lYm9hcmQgPSByZW5kZXJQbGF5ZXJHYW1lYm9hcmQocmVhbFBsYXllciwgcGxheWVyQm9hcmRCb3gpO1xyXG4gICAgcmVuZGVyQ29tcEdhbWVib2FyZChjb21wUGxheWVyLCBjb21wdXRlckJvYXJkQm94KVxyXG5cclxuICAgIHBsYXllckdhbWVib2FyZC5yZW5kZXIoKTtcclxuXHJcbn1cclxuXHJcblxyXG5leHBvcnQge1xyXG4gICAgcGxheWVyR2FtZWJvYXJkLFxyXG4gICAgcGxheUdhbWVcclxufVxyXG4iLCJpbXBvcnQgeyBwbGF5R2FtZSB9IGZyb20gXCIuL2dhbWVcIjtcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHtcbiAgICBwbGF5R2FtZSgpXG59KSJdLCJuYW1lcyI6WyJTaGlwIiwic2hpcExlbmd0aCIsImhpdHMiLCJoaXQiLCJpc1N1bmsiLCJsZW5ndGgiLCJnZXRIaXRzIiwiUGxheWVyIiwicGxheWVydHlwZSIsInR5cGUiLCJnYW1lYm9hcmQiLCJwbGF5ZXIiLCJnYW1lQm9hcmQiLCJpIiwiaiIsImNyZWF0ZUdhbWVCb2FyZCIsInNoaXBzIiwiX2lzV2l0aGluQm91bmRzIiwiaW5kZXgiLCJjaGVja0VuZEdhbWUiLCJjb3VudGVyIiwic2hpcCIsImNvbnNvbGUiLCJsb2ciLCJsb3NlciIsIm1vZGFsIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwib3ZlcmxheSIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbGFzc0xpc3QiLCJhZGQiLCJsb2NhdGlvbiIsInJlbG9hZCIsIm9wZW5Nb2RhbCIsInRleHRDb250ZW50IiwicmVtb3ZlIiwicGxhY2VTaGlwIiwiY29sIiwicm93IiwiZGlyZWN0aW9uIiwidmFsdWUiLCJwdXNoIiwicmVjZWl2ZUF0dGFjayIsImJvYXJkQ2VsbCIsIkdhbWVib2FyZCIsInBsYXllckdhbWVib2FyZCIsInBsYXllckJvYXJkQm94IiwiY29tcHV0ZXJCb2FyZEJveCIsInJlYWxQbGF5ZXIiLCJjb21wUGxheWVyIiwiZm91clNoaXAiLCJ0aHJlZVNoaXBPbmUiLCJ0aHJlZVNoaXBUd28iLCJ0d29TaGlwT25lIiwidHdvU2hpcFR3byIsInR3b1NoaXBUaHJlZSIsIm9uZVNoaXBPbmUiLCJvbmVTaGlwVHdvIiwib25lU2hpcFRocmVlIiwib25lU2hpcEZvdXIiLCJvcmllbnRhdGlvbiIsIk1hdGgiLCJyYW5kb20iLCJmb3JFYWNoIiwic2hpcFBsYWNlZCIsImZsb29yIiwicmVuZGVyU2hpcCIsImJveCIsImNvbnRhaW5lciIsImNyZWF0ZUVsZW1lbnQiLCJyZW5kZXIiLCJzcXVhcmUiLCJpbm5lckhUTUwiLCJhcHBlbmRDaGlsZCIsImFwcGVuZCIsImF0dGFjayIsImF0dGVtcHQiLCJjb2xSYW5kb20iLCJyb3dSYW5kb20iLCJzZXRUaW1lb3V0IiwicmVuZGVyUGxheWVyR2FtZWJvYXJkIiwicmVuZGVyQ29tcEdhbWVib2FyZCIsInBsYXlHYW1lIl0sInNvdXJjZVJvb3QiOiIifQ==